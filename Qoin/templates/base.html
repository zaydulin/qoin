{% load static generals_tag i18n %}
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>{% get_settings_first as settings %}{{settings.name}} - {% block title %}{% endblock title %}</title>
    <meta content="{% block description %}{% endblock description %}" name="description">
    <meta property="og:title" content="{% block propertytitle %} {% endblock propertytitle %}">
    <meta property="og:description" content="{% block propertydescription %}{% endblock propertydescription %}">
    <meta property="og:image" content="{% block propertyimage %}{% endblock propertyimage %}">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="{% if settings.favicon %}{{settings.favicon.url}}{% endif %}" />

    <link rel="stylesheet" href="{% static 'site/assets/css/normalize.min.css' %}">
    <link rel="stylesheet" href="{% static 'site/assets/css/style.min.css' %}">
<body class="index">
<div class="body-wrapper"  id="content">
    <header class="header">
        <div class="container">
            <div class="header__container"><a  href="{% url 'webmain:home' %}" hx-get="{% url 'webmain:home' %}" hx-target="#content-body" hx-push-url="true"  class="header__logo">
                <picture>
                    <source media="(min-width: 743px)"
                            srcset="{% static 'site/assets/img/Qoin logo.svg' %}, {% static 'site/assets/img/Qoin logo.svg' %}">
                    <img src="{% static 'site/assets/img/Qoin logo.svg' %}" srcset="{% static 'site/assets/img/Qoin logo.svg' %}" alt="Logo" width="120"
                         height="30"></picture>
            </a>
                <nav class="header__nav main-nav">
                    <div class="main-nav__wrapper">
                        <ul class="main-nav__list">
<li class="main-nav__item">
            <a href="{% url 'webmain:home' %}"
               hx-get="{% url 'webmain:home' %}"
               hx-target="#content-body"
               hx-push-url="true"
               class="main-nav__link {% if request.resolver_match.url_name == 'home' %}main-nav__link--active{% endif %}">
                Home
            </a>
        </li>
        <li class="main-nav__item">
            <a href="{% url 'webmain:about' %}"
               hx-get="{% url 'webmain:about' %}"
               hx-target="#content-body"
               hx-push-url="true"
               class="main-nav__link {% if request.resolver_match.url_name == 'about' %}main-nav__link--active{% endif %}">
                About us
            </a>
        </li>
        <li class="main-nav__item">
            <a href="{% url 'webmain:exchange' %}"
               hx-get="{% url 'webmain:exchange' %}"
               hx-target="#content-body"
               hx-push-url="true"
               class="main-nav__link {% if request.resolver_match.url_name == 'exchange' %}main-nav__link--active{% endif %}">
                Exchange
            </a>
        </li>
        <li class="main-nav__item">
            <a href="{% url 'webmain:aml' %}"
               hx-get="{% url 'webmain:aml' %}"
               hx-target="#content-body"
               hx-push-url="true"
               class="main-nav__link {% if request.resolver_match.url_name == 'aml' %}main-nav__link--active{% endif %}">
                AML/KYC
            </a>
        </li>
        <li class="main-nav__item">
            <a href="{% url 'webmain:contact' %}"
               hx-get="{% url 'webmain:contact' %}"
               hx-target="#content-body"
               hx-push-url="true"
               class="main-nav__link {% if request.resolver_match.url_name == 'contact' %}main-nav__link--active{% endif %}">
                Contacts
            </a>
        </li>

<script>
// JavaScript для обновления активного класса после HTMX загрузки
document.addEventListener('DOMContentLoaded', function() {
    function updateActiveNav() {
        // Убираем активный класс у всех ссылок
        document.querySelectorAll('.main-nav__link').forEach(link => {
            link.classList.remove('main-nav__link--active');
        });

        // Добавляем активный класс к текущей странице
        const currentPath = window.location.pathname;
        document.querySelectorAll('.main-nav__link').forEach(link => {
            if (link.getAttribute('href') === currentPath) {
                link.classList.add('main-nav__link--active');
            }
        });
    }

    // Обновляем при загрузке страницы
    updateActiveNav();

    // Обновляем после HTMX навигации
    document.body.addEventListener('htmx:afterSwap', function(evt) {
        updateActiveNav();
    });

    // Обновляем при изменении истории браузера
    window.addEventListener('popstate', function() {
        setTimeout(updateActiveNav, 100);
    });
});
</script>
</ul>
                    </div>
                    <button class="main-nav__button" aria-label="Open menu"><span></span> <span></span> <span></span>
                    </button>
                </nav>
                <a href="{% url 'webmain:contact' %}" hx-get="{% url 'webmain:contact' %}" hx-target="#content-body" hx-push-url="true" class="header__button">Start now</a></div>
        </div>
    </header>
    <main class="main" id="content-body">

        {% block content %}{% endblock content %}
    </main>
    <footer class="footer">
        <div class="container">
            <div class="footer__container"><a  href="{% url 'webmain:home' %}" hx-get="{% url 'webmain:home' %}" hx-target="#content-body" hx-push-url="true" class="footer__logo">
                <img src="{% static 'site/assets/img/Qoin logo.svg' %}"
                     srcset="{% static 'site/assets/img/Qoin logo.svg"
                     alt="logo" width="178" height="52"></a>
                <ul class="footer__nav">
                    <li class="footer__nav-item">
                        <a href="{% url 'webmain:home' %}" hx-get="{% url 'webmain:home' %}" hx-target="#content-body" hx-push-url="true" class="footer__nav-link">Home</a>
                    </li>
                    <li class="footer__nav-item">
                        <a href="{% url 'webmain:about' %}" hx-get="{% url 'webmain:about' %}" hx-target="#content-body" hx-push-url="true"  class="footer__nav-link">About us</a>
                    </li>
                    <li class="footer__nav-item">
                        <a href="{% url 'webmain:exchange' %}" hx-get="{% url 'webmain:exchange' %}" hx-target="#content-body" hx-push-url="true"  class="footer__nav-link">Exchange</a>
                    </li>
                    <li class="footer__nav-item">
                        <a href="{% url 'webmain:aml' %}" hx-get="{% url 'webmain:aml' %}" hx-target="#content-body" hx-push-url="true"  class="footer__nav-link">AML/KYC</a>
                    </li>

                    <li class="footer__nav-item">
                        <a href="{% url 'webmain:contact' %}" hx-get="{% url 'webmain:contact' %}" hx-target="#content-body" hx-push-url="true"  class="footer__nav-link">Contacts</a>
                    </li>
                </ul>
                {% load static generals_tag i18n %}

                <ul class="footer__docs">
                    {# Privacy policy #}
                    {% get_pages_by_type 4 as privacy_pages %}
                    {% for page in privacy_pages %}
                    <li class="footer__docs-item">
                        <a href="{% url 'webmain:page' page.slug %}"
                           hx-get="{% url 'webmain:page' page.slug %}"
                           hx-target="#content-body"
                           hx-push-url="true"
                           class="footer__docs-link">{{ page.name }}</a>
                    </li>
                    {% endfor %}

                    {# Terms of use #}
                    {% get_pages_by_type 5 as terms_pages %}
                    {% for page in terms_pages %}
                    <li class="footer__docs-item">
                        <a href="{% url 'webmain:page' page.slug %}"
                           hx-get="{% url 'webmain:page' page.slug %}"
                           hx-target="#content-body"
                           hx-push-url="true"
                           class="footer__docs-link">{{ page.name }}</a>
                    </li>
                    {% endfor %}

                    {# Partners #}
                    {% get_pages_by_type 6 as partners_pages %}
                    {% for page in partners_pages %}
                    <li class="footer__docs-item">
                        <a href="{% url 'webmain:page' page.slug %}"
                           hx-get="{% url 'webmain:page' page.slug %}"
                           hx-target="#content-body"
                           hx-push-url="true"
                           class="footer__docs-link">{{ page.name }}</a>
                    </li>
                    {% endfor %}

                    {# Help #}
                    {% get_pages_by_type 7 as help_pages %}
                    {% for page in help_pages %}
                    <li class="footer__docs-item">
                        <a href="{% url 'webmain:page' page.slug %}"
                           hx-get="{% url 'webmain:page' page.slug %}"
                           hx-target="#content-body"
                           hx-push-url="true"
                           class="footer__docs-link">{{ page.name }}</a>
                    </li>
                    {% endfor %}

                    {# Cookies #}
                    {% get_pages_by_type 8 as cookies_pages %}
                    {% for page in cookies_pages %}
                    <li class="footer__docs-item">
                        <a href="{% url 'webmain:page' page.slug %}"
                           hx-get="{% url 'webmain:page' page.slug %}"
                           hx-target="#content-body"
                           hx-push-url="true"
                           class="footer__docs-link">{{ page.name }}</a>
                    </li>
                    {% endfor %}

                    {# User agreement #}
                    {% get_pages_by_type 9 as user_agreement_pages %}
                    {% for page in user_agreement_pages %}
                    <li class="footer__docs-item">
                        <a href="{% url 'webmain:page' page.slug %}"
                           hx-get="{% url 'webmain:page' page.slug %}"
                           hx-target="#content-body"
                           hx-push-url="true"
                           class="footer__docs-link">{{ page.name }}</a>
                    </li>
                    {% endfor %}
                </ul>
                <p class="footer__copyright"><a href="#">Privacy Policy</a> 2025 © Qoin+ All rights reserved<br>ILYA BIG
                    STAR LIMITED LIABILITY COMPANY<br>Michała Kleofasa Ogińskiego 11/9<br>03-318 Warsaw, Poland</p>
            </div>
        </div>
    </footer>
</div>
{% block footer %}{% endblock footer %}
<script src="{% static 'site/htmx.min.js' %}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
    const promoSection = document.querySelector('.promo.promo--main');
    const decorationElements = document.querySelectorAll('.promo__decoration > *');

    if (!promoSection || !decorationElements.length) return;

    // Добавляем перспективу для 3D эффекта
    promoSection.style.perspective = '1000px';

    promoSection.addEventListener('mousemove', function(e) {
        const sectionRect = promoSection.getBoundingClientRect();
        const mouseX = e.clientX - sectionRect.left;
        const mouseY = e.clientY - sectionRect.top;

        const centerX = sectionRect.width / 2;
        const centerY = sectionRect.height / 2;

        const distanceX = (mouseX - centerX) / centerX;
        const distanceY = (mouseY - centerY) / centerY;

        decorationElements.forEach((element, index) => {
            // Интенсивность увеличивается с каждым элементом
            const baseSpeed = 0.05;
            const speed = baseSpeed + (index * 0.03);
            const rotationPower = 8 + (index * 3);
            const tiltPower = 5 + (index * 2);

            // Смещение
            const moveX = distanceX * speed * 120;
            const moveY = distanceY * speed * 120;

            // 3D вращение
            const rotateY = distanceX * rotationPower;
            const rotateX = -distanceY * rotationPower * 0.8;
            const rotateZ = (distanceX * distanceY) * tiltPower;

            // Дополнительные эффекты
            const skewX = distanceY * 2;
            const skewY = distanceX * 1.5;
            const scale = 1 + (Math.abs(distanceX * distanceY) * 0.1);

            // Параллакс с глубиной
            const translateZ = index * 10 - (Math.abs(distanceX) * 20);

            element.style.transform = `
                translate3d(${moveX}px, ${moveY}px, ${translateZ}px)
                rotateY(${rotateY}deg)
                rotateX(${rotateX}deg)
                rotateZ(${rotateZ}deg)
                skew(${skewX}deg, ${skewY}deg)
                scale(${scale})
            `;

            // Добавляем тень для усиления 3D эффекта
            element.style.filter = `
                drop-shadow(${-moveX * 0.1}px ${-moveY * 0.1}px 8px rgba(0,0,0,0.3))
            `;

            element.style.transition = 'all 0.12s ease-out';
            element.style.transformStyle = 'preserve-3d';
            element.style.willChange = 'transform, filter';
        });
    });

    promoSection.addEventListener('mouseenter', function() {
        decorationElements.forEach(element => {
            element.style.transition = 'all 0.12s ease-out';
        });
    });

    promoSection.addEventListener('mouseleave', function() {
        decorationElements.forEach(element => {
            element.style.transform = `
                translate3d(0, 0, 0)
                rotateY(0deg)
                rotateX(0deg)
                rotateZ(0deg)
                skew(0deg, 0deg)
                scale(1)
            `;
            element.style.filter = 'drop-shadow(0 0 0 rgba(0,0,0,0))';
            element.style.transition = 'all 0.9s cubic-bezier(0.19, 1, 0.22, 1)';
        });
    });
});
</script>
<script>
document.addEventListener("DOMContentLoaded", function() {
    const menuButton = document.querySelector('.main-nav__button');
    const existingMenu = document.querySelector('.main-nav__wrapper');

    if (menuButton && existingMenu) {
        menuButton.addEventListener('click', function() {
            console.log('Кнопка нажата!');
            createMenuPopup(existingMenu);
        });
    } else {
        console.log('Кнопка не найдена или меню отсутствует!');
    }
});

function createMenuPopup(existingMenu) {
    if (document.querySelector('.menu-popup')) return;

    const body = document.querySelector('body');

    const popup = document.createElement('div');
    popup.classList.add('menu-popup');

    const popupContent = `
        <div class="popup-content">
            <button class="popup-close-btn" aria-label="Close menu">×</button>
            <div class="popup-menu-wrapper"></div>
        </div>
    `;

    popup.innerHTML = popupContent;
    body.appendChild(popup);

    // Клонируем существующее меню и меняем классы
    const menuWrapper = popup.querySelector('.popup-menu-wrapper');
    const clonedMenu = existingMenu.cloneNode(true);

    // Меняем классы у элементов меню
    clonedMenu.classList.remove('main-nav__wrapper');
    clonedMenu.classList.add('popup-nav-wrapper');

    const navList = clonedMenu.querySelector('.main-nav__list');
    if (navList) {
        navList.classList.remove('main-nav__list');
        navList.classList.add('popup-nav-list');
    }

    const navItems = clonedMenu.querySelectorAll('.main-nav__item');
    navItems.forEach(item => {
        item.classList.remove('main-nav__item');
        item.classList.add('popup-nav-item');
    });

    const navLinks = clonedMenu.querySelectorAll('.main-nav__link');
    navLinks.forEach(link => {
        link.classList.remove('main-nav__link');
        link.classList.add('popup-nav-link');
    });

    menuWrapper.appendChild(clonedMenu);

    // Закрытие попапа
    const closeButton = popup.querySelector('.popup-close-btn');
    closeButton.addEventListener('click', () => {
        popup.remove();
        body.style.overflow = 'auto';
    });

    popup.addEventListener('click', (e) => {
        if (e.target === popup) {
            popup.remove();
            body.style.overflow = 'auto';
        }
    });

    document.addEventListener('keydown', function closeOnEscape(e) {
        if (e.key === 'Escape') {
            popup.remove();
            body.style.overflow = 'auto';
            document.removeEventListener('keydown', closeOnEscape);
        }
    });

    body.style.overflow = 'hidden';
}
</script>
<style>
    .menu-popup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    display: flex;
    justify-content: flex-end;
}

.popup-content {
    width: 300px;
    height: 100%;
    background: white;
    padding: 60px 20px 20px 20px;
    position: relative;
    overflow-y: auto;
}

.popup-close-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    z-index: 1001;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #333;
}

/* Стили для меню в попапе */
.popup-nav-wrapper {
    margin-top: 20px;
}

.popup-nav-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.popup-nav-item {
    margin-bottom: 10px;
}

.popup-nav-link {
    display: block;
    padding: 12px 15px;
    text-decoration: none;
    color: #333;
    font-size: 16px;
    border-radius: 5px;
    transition: all 0.3s ease;
    background: transparent;
    border: none;
    width: 100%;
    text-align: left;
}

.popup-nav-link:hover {
    background-color: #f5f5f5;
    color: #000;
}

/* Активный状态 для ссылок */
.popup-nav-link.active {
    background-color: #007bff;
    color: white;
}

/* Анимации */
.menu-popup {
    animation: fadeIn 0.3s ease;
}

.popup-content {
    animation: slideIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideIn {
    from { transform: translateX(100%); }
    to { transform: translateX(0); }
}

/* Адаптивность */
@media (max-width: 480px) {
    .popup-content {
        width: 100%;
        max-width: 280px;
    }
}
</style>
<script src="{% static 'site/assets/js/script.js' %}"></script>
</body>
</html>